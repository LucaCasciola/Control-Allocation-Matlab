<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">u</span> = CascadedPseudoinverse(<span class="var type1" id="S3T2U6">m</span>,<span class="var type1" id="S4T3U7">B</span>,<span class="var type1" id="S5T4U8">W</span>,<span class="var type1" id="S6T5U9">u_lim</span>,<span class="var type1" id="S7T6U10">reductionType</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%at the Breginning we move from an attainaBrle position</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%check if the matrices are correct</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">    <span class="keyword">if</span> not(<span class="mxinfo " id="T7:U7">isequal(<span class="mxinfo " id="T8:U8">size(<span class="var type1" id="S6T5U20">u_lim</span>,1)</span>,<span class="mxinfo " id="T8:U10">size(<span class="var type1" id="S4T3U24">B</span>,2)</span>,<span class="mxinfo " id="T8:U12">size(<span class="var type1" id="S5T4U28">W</span>,1)</span>,<span class="mxinfo " id="T8:U14">size(<span class="var type1" id="S5T4U32">W</span>,2)</span>)<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">       &amp;&amp; isequal(<span class="mxinfo " id="T9:U16">length(<span class="var type1" id="S3T2U38">m</span>)</span>,<span class="mxinfo " id="T8:U18">size(<span class="var type1" id="S4T3U41">B</span>,1)</span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">        error (<span class="string">'input matrix dimensions do not match'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="comment">%Recursively compute until solution is found or all the effectors are saturated</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T2:U20"><span class="var type1" id="S13T2U49">m_res</span> = <span class="var type1" id="S3T2U50">m</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo " id="T1:U23"><span class="var type1" id="S14T1U53">u_sat</span> = <span class="mxinfo " id="T1:U25">zeros(<span class="mxinfo " id="T6:U26">length(<span class="var type1" id="S6T5U58">u_lim</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T1:U28"><span class="var type1" id="S16T1U62">ut</span> = <span class="mxinfo " id="T1:U30">zeros(<span class="mxinfo " id="T6:U31">length(<span class="var type1" id="S6T5U67">u_lim</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo " id="T1:U33"><span class="var type1" id="S2T1U71">u</span> = <span class="mxinfo " id="T1:U35">zeros(<span class="mxinfo " id="T6:U36">length(<span class="var type1" id="S6T5U76">u_lim</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T1:U38"><span class="var type1" id="S17T1U80">u_index</span> = <span class="mxinfo " id="T1:U40"><span class="mxinfo " id="T10:U41">[1:<span class="mxinfo " id="T8:U42">length(<span class="var type1" id="S6T5U88">u_lim</span>)</span>]</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T3:U44"><span class="var type1" id="S18T3U91">Br</span> = <span class="var type1" id="S4T3U92">B</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo " id="T4:U47"><span class="var type1" id="S19T4U95">Wr</span> = <span class="var type1" id="S5T4U96">W</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo " id="T5:U50"><span class="var type1" id="S20T5U99">u_limr</span> = <span class="var type1" id="S6T5U100">u_lim</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">    <span class="keyword">while</span>(not(isempty(<span class="var type1" id="S17T1U107">u_index</span>))) <span class="comment">%till we run out of effectors</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">        <span class="comment">%check the type of system and then compute the pseudoinverse</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">            <span class="mxinfo " id="T6:U54"><span class="var type1" id="S22T6U110">order</span> = <span class="mxinfo " id="T6:U56"><span class="mxinfo " id="T8:U57">size(<span class="var type1" id="S18T3U114">Br</span>,2)</span>-<span class="mxinfo " id="T8:U59">size(<span class="var type1" id="S18T3U118">Br</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">            <span class="keyword">if</span> <span class="var type1" id="S22T6U123">order</span> &gt; 0 <span class="comment">%over-determined, solution that minimizes the 2norm</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">                <span class="mxinfo " id="T1:U62"><span class="var type1" id="S16T1U127">ut</span> = <span class="mxinfo " id="T1:U64"><span class="mxinfo " id="T11:U65"><span class="mxinfo " id="T11:U66"><span class="mxinfo " id="T4:U67">inv(<span class="var type1" id="S19T4U133">Wr</span>)</span>*<span class="mxinfo " id="T11:U69"><span class="var type1" id="S18T3U135">Br</span>.'</span></span>*<span class="mxinfo " id="T12:U71">inv(<span class="mxinfo " id="T12:U72"><span class="mxinfo " id="T3:U73"><span class="var type1" id="S18T3U140">Br</span>*<span class="mxinfo " id="T4:U75">inv(<span class="var type1" id="S19T4U143">Wr</span>)</span></span>*<span class="mxinfo " id="T11:U77"><span class="var type1" id="S18T3U145">Br</span>.'</span></span>)</span></span>*<span class="var type1" id="S13T2U146">m_res</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">            <span class="keyword">elseif</span> <span class="var type0" id="S22T0U149">order</span> &lt; 0 <span class="comment">%under-determined, solution that minimizes the error</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">                <span class="var type0" id="S16T0U153">ut</span> = inv(<span class="var type0" id="S18T0U160">Br</span>.'*<span class="var type0" id="S18T0U161">Br</span>)*<span class="var type0" id="S18T0U163">Br</span>.'*<span class="var type0" id="S13T0U164">m_res</span>;   </span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">            <span class="keyword">else</span> <span class="comment">%order = 0, sqared thus invertiBrle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">                <span class="var type0" id="S16T0U168">ut</span> = inv(<span class="var type0" id="S18T0U172">Br</span>)*<span class="var type0" id="S13T0U173">m_res</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line">        <span class="comment">%reduce the solution, if needed. If not needed exit the cycle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T7:U80">not(<span class="mxinfo " id="T7:U81"><span class="mxinfo " id="T7:U82">any(<span class="mxinfo " id="T13:U83"><span class="var type1" id="S16T1U182">ut</span> &lt; <span class="mxinfo " id="T1:U85"><span class="var type1" id="S20T5U184">u_limr</span>(<span class="mxinfo " id="T14:U87">:</span>,<span class="mxinfo " id="T6:U88">1</span>)</span></span>)</span>||<span class="mxinfo " id="T7:U89">any(<span class="mxinfo " id="T13:U90"><span class="var type1" id="S16T1U190">ut</span> &gt; <span class="mxinfo " id="T1:U92"><span class="var type1" id="S20T5U192">u_limr</span>(<span class="mxinfo " id="T14:U94">:</span>,<span class="mxinfo " id="T6:U95">2</span>)</span></span>)</span></span>)</span> <span class="comment">%Wre found a solution then Brreak</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line">                <span class="comment">%save the saturaded value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line">                    <span class="keyword">for</span> <span class="var type1" id="S25T6U197">j</span> = <span class="mxinfo " id="T1:U97"><span class="mxinfo " id="T6:U98">1</span>:<span class="mxinfo " id="T6:U99">length(<span class="var type1" id="S16T1U202">ut</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line">                            <span class="mxinfo " id="T6:U101"><span class="mxinfo " id="T6:U102"><span class="var type1" id="S2T1U206">u</span>(<span class="mxinfo " id="T6:U104"><span class="var type1" id="S17T1U208">u_index</span>(<span class="var type1" id="S25T6U209">j</span>)</span>)</span> = <span class="mxinfo " id="T6:U107"><span class="var type1" id="S16T1U211">ut</span>(<span class="var type1" id="S25T6U212">j</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line">                <span class="keyword">return</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">            <span class="keyword">else</span> <span class="comment">%some deflectors are past their limit</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line">                <span class="comment">%take note of Wrhich one are saturated</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line">                    <span class="mxinfo " id="T1:U110"><span class="var type1" id="S14T1U217">u_sat</span> = <span class="mxinfo " id="T1:U112">zeros(<span class="mxinfo " id="T6:U113">length(<span class="var type1" id="S16T1U222">ut</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line">                    <span class="mxinfo " id="T15:U115"><span class="mxinfo " id="T15:U116"><span class="var type1" id="S14T1U227">u_sat</span>(<span class="mxinfo " id="T13:U118"><span class="var type1" id="S16T1U229">ut</span> &lt; <span class="mxinfo " id="T1:U120"><span class="var type1" id="S20T5U231">u_limr</span>(<span class="mxinfo " id="T14:U122">:</span>,<span class="mxinfo " id="T6:U123">1</span>)</span></span>)</span> = <span class="mxinfo " id="T6:U124">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line">                    <span class="mxinfo " id="T15:U125"><span class="mxinfo " id="T15:U126"><span class="var type1" id="S14T1U238">u_sat</span>(<span class="mxinfo " id="T13:U128"><span class="var type1" id="S16T1U240">ut</span> &gt; <span class="mxinfo " id="T1:U130"><span class="var type1" id="S20T5U242">u_limr</span>(<span class="mxinfo " id="T14:U132">:</span>,<span class="mxinfo " id="T6:U133">2</span>)</span></span>)</span> = <span class="mxinfo " id="T6:U134">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">47</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48">48</a></span><span class="line">                <span class="comment">%reduce their value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49">49</a></span><span class="line">                    <span class="keyword">switch</span> <span class="var type1" id="S7T6U247">reductionType</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50">50</a></span><span class="line">                        <span class="keyword">case</span> <span class="mxinfo " id="T6:U136">1</span> <span class="comment">%truncation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51">51</a></span><span class="line">                            <span class="mxinfo " id="T1:U137"><span class="var type1" id="S16T1U252">ut</span> = <span class="mxinfo " id="T1:U139">min(<span class="var type1" id="S16T1U255">ut</span>, <span class="mxinfo " id="T1:U141"><span class="var type1" id="S20T5U257">u_limr</span>(<span class="mxinfo " id="T14:U143">:</span>,<span class="mxinfo " id="T16:U144">2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52">52</a></span><span class="line">                            <span class="mxinfo " id="T1:U145"><span class="var type1" id="S16T1U262">ut</span> = <span class="mxinfo " id="T1:U147">max(<span class="var type1" id="S16T1U265">ut</span>, <span class="mxinfo " id="T1:U149"><span class="var type1" id="S20T5U267">u_limr</span>(<span class="mxinfo " id="T14:U151">:</span>,<span class="mxinfo " id="T16:U152">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53">53</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54">54</a></span><span class="line">                        <span class="keyword">case</span> <span class="mxinfo " id="T6:U153">2</span> <span class="comment">%scaling solution -&gt; direction preserving</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55">55</a></span><span class="line">                            <span class="mxinfo " id="T1:U154"><span class="var type1" id="S28T1U274">a</span> = <span class="mxinfo " id="T1:U156">zeros(<span class="mxinfo " id="T6:U157">length(<span class="var type1" id="S2T1U279">u</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56">56</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57">57</a></span><span class="line">                            <span class="keyword">for</span> <span class="var type1" id="S29T6U283">i</span> = <span class="mxinfo " id="T1:U160"><span class="mxinfo " id="T6:U161">1</span>:<span class="mxinfo " id="T6:U162">length(<span class="var type1" id="S2T1U288">u</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58">58</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T7:U164"><span class="mxinfo " id="T6:U165"><span class="var type1" id="S2T1U293">u</span>(<span class="var type1" id="S29T6U294">i</span>)</span>&gt;<span class="mxinfo " id="T6:U168">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59">59</a></span><span class="line">                                   <span class="mxinfo " id="T6:U169"><span class="mxinfo " id="T6:U170"><span class="var type1" id="S28T1U299">a</span>(<span class="var type1" id="S29T6U300">i</span>)</span> = <span class="mxinfo " id="T6:U173"><span class="mxinfo " id="T6:U174"><span class="var type1" id="S16T1U303">ut</span>(<span class="var type1" id="S29T6U304">i</span>)</span>/<span class="mxinfo " id="T6:U177"><span class="var type1" id="S20T5U306">u_limr</span>(<span class="var type1" id="S29T6U307">i</span>,<span class="mxinfo " id="T16:U180">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60">60</a></span><span class="line">                                <span class="keyword">elseif</span> <span class="mxinfo " id="T7:U181"><span class="mxinfo " id="T6:U182"><span class="var type1" id="S2T1U312">u</span>(<span class="var type1" id="S29T6U313">i</span>)</span>&lt;<span class="mxinfo " id="T6:U185">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61">61</a></span><span class="line">                                   <span class="mxinfo " id="T6:U186"><span class="mxinfo " id="T6:U187"><span class="var type1" id="S28T1U318">a</span>(<span class="var type1" id="S29T6U319">i</span>)</span> = <span class="mxinfo " id="T6:U190"><span class="mxinfo " id="T6:U191"><span class="var type1" id="S16T1U322">ut</span>(<span class="var type1" id="S29T6U323">i</span>)</span>/<span class="mxinfo " id="T6:U194"><span class="var type1" id="S20T5U325">u_limr</span>(<span class="var type1" id="S29T6U326">i</span>,<span class="mxinfo " id="T16:U197">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62">62</a></span><span class="line">                                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63">63</a></span><span class="line">                                   <span class="mxinfo " id="T6:U198"><span class="mxinfo " id="T6:U199"><span class="var type1" id="S28T1U332">a</span>(<span class="var type1" id="S29T6U333">i</span>)</span> = <span class="mxinfo " id="T6:U202">0</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64">64</a></span><span class="line">                                <span class="keyword">end</span>          </span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65">65</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66">66</a></span><span class="line">                            <span class="mxinfo " id="T6:U203"><span class="var type1" id="S30T6U337">a_max</span> = <span class="mxinfo " id="T6:U205">max(<span class="var type1" id="S28T1U340">a</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67">67</a></span><span class="line">                            <span class="mxinfo " id="T1:U207"><span class="var type1" id="S16T1U343">ut</span> = <span class="mxinfo " id="T1:U209"><span class="var type1" id="S16T1U345">ut</span>/<span class="var type1" id="S30T6U346">a_max</span></span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68">68</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69">69</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70">70</a></span><span class="line">                <span class="comment">%save the saturaded value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71">71</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S25T6U349">j</span> = <span class="mxinfo " id="T1:U213"><span class="mxinfo " id="T6:U214">1</span>:<span class="mxinfo " id="T6:U215">length(<span class="var type1" id="S16T1U354">ut</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72">72</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T7:U217"><span class="mxinfo " id="T6:U218"><span class="var type1" id="S14T1U359">u_sat</span>(<span class="var type1" id="S25T6U360">j</span>)</span> == <span class="mxinfo " id="T6:U221">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73">73</a></span><span class="line">                        <span class="mxinfo " id="T6:U222"><span class="mxinfo " id="T6:U223"><span class="var type1" id="S2T1U365">u</span>(<span class="mxinfo " id="T6:U225"><span class="var type1" id="S17T1U367">u_index</span>(<span class="var type1" id="S25T6U368">j</span>)</span>)</span> = <span class="mxinfo " id="T6:U228"><span class="var type1" id="S16T1U370">ut</span>(<span class="var type1" id="S25T6U371">j</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74">74</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75">75</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76">76</a></span><span class="line">                           </span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77">77</a></span><span class="line">                <span class="comment">%compute the generated moment and the residual moment</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78">78</a></span><span class="line">                <span class="mxinfo " id="T2:U231"><span class="var type1" id="S13T2U374">m_res</span> = <span class="mxinfo " id="T2:U233"><span class="var type1" id="S3T2U376">m</span> - <span class="mxinfo " id="T2:U235"><span class="var type1" id="S4T3U378">B</span>*<span class="var type1" id="S2T1U379">u</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79">79</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80">80</a></span><span class="line">                <span class="comment">%reduce matrix Br, Wr, u_lim (erase saturated effectors)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81">81</a></span><span class="line">                <span class="mxinfo " id="T15:U238"><span class="mxinfo " id="T1:U239"><span class="var type1" id="S17T1U383"><span class="message error" id="M1F1C">u_index</span></span></span>(<span class="mxinfo " id="T13:U240"><span class="var type1" id="S14T1U385">u_sat</span> == <span class="mxinfo " id="T6:U242">1</span></span>)= []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82">82</a></span><span class="line">                <span class="mxinfo " id="T17:U243"><span class="mxinfo " id="T3:U244"><span class="var type1" id="S18T3U392"><span class="message error" id="M2F1C">Br</span></span></span>(:,<span class="mxinfo " id="T13:U245"><span class="var type1" id="S14T1U395">u_sat</span> == <span class="mxinfo " id="T6:U247">1</span></span>)=[]</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83">83</a></span><span class="line">                <span class="mxinfo " id="T18:U248"><span class="mxinfo " id="T4:U249"><span class="var type1" id="S19T4U402"><span class="message error" id="M3F1C">Wr</span></span></span>(:,<span class="mxinfo " id="T13:U250"><span class="var type1" id="S14T1U405">u_sat</span> == <span class="mxinfo " id="T6:U252">1</span></span>)=[]</span>; <span class="mxinfo " id="T19:U253"><span class="mxinfo " id="T4:U254"><span class="var type1" id="S19T4U412"><span class="message error" id="M4F1C">Wr</span></span></span>(<span class="mxinfo " id="T13:U255"><span class="var type1" id="S14T1U414">u_sat</span> == <span class="mxinfo " id="T6:U257">1</span></span>,:)=[]</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84">84</a></span><span class="line">                <span class="mxinfo " id="T20:U258"><span class="mxinfo " id="T5:U259"><span class="var type1" id="S20T5U422"><span class="message error" id="M5F1C">u_limr</span></span></span>(<span class="mxinfo " id="T13:U260"><span class="var type1" id="S14T1U424">u_sat</span> == <span class="mxinfo " id="T6:U262">1</span></span>,:) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85">85</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86">86</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87">87</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88">88</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89">89</a></span><span class="line">    clear <span class="string">u_index</span> <span class="string">Br</span> <span class="string">Wr</span> <span class="string">u_limr</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90">90</a></span><span class="line">    <span class="var type0" id="S2T0U437">u</span> = <span class="var type0" id="S2T0U438">u</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91">91</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92">92</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93">93</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94">94</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95">95</a></span><span class="line">    </span></span>
</pre>
</body>
</html>
